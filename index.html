const apiKey = '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';  // New key here

async function getAIResponse(prompt) {
  try {
    const response = await fetch('https://api.openai.com/v1/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${apiKey}`,  // Ensure Bearer + Key
      },
      body: JSON.stringify({
        model: 'text-davinci-003',
        prompt: prompt,
        max_tokens: 100,
        temperature: 0.7,
      }),
    });

    if (!response.ok) {
      throw new Error(`API error: ${response.status} - ${response.statusText}`);
    }

    const data = await response.json();

    if (data.choices && data.choices.length > 0) {
      const aiResponse = data.choices[0].text.trim();
      speak(aiResponse);
    } else {
      speak('Sorry, I could not generate a response.');
    }
  } catch (error) {
    console.error('Error fetching AI response:', error);
    speak('There was an error connecting to the AI service.');
  }
}

function speak(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'en-US';
  window.speechSynthesis.speak(utterance);
}
